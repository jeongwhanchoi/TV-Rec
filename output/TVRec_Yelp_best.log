2025-05-23 18:21:20,063 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='TVRec_Yelp_best', num_items=10, num_users=30432, save=True, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=8, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='TVRec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.1, initializer_range=0.02, dt_min=0.0, dt_max=0.5, M=16, reg_weight=0.001, device='cuda', data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/TVRec_Yelp_best.pt')
2025-05-23 18:21:20,571 - TVRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.1, inplace=False)
  (item_encoder): NVRecEncoder(
    (blocks): ModuleList(
      (0-1): 2 x NVRecBlock(
        (layer): NVRecLayer(
          (out_dropout): Dropout(p=0.1, inplace=False)
          (LayerNorm): LayerNorm()
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
)
2025-05-23 18:21:20,898 - Total Parameters: 1355424
2025-05-23 18:21:47,422 - {'epoch': 0, 'rec_loss': '9.2578'}
2025-05-23 18:22:00,557 - {'Epoch': 0, 'HR@5': '0.0182', 'NDCG@5': '0.0115', 'HR@10': '0.0306', 'NDCG@10': '0.0155', 'HR@20': '0.0498', 'NDCG@20': '0.0203'}
2025-05-23 18:22:00,558 - Validation score increased.  Saving model ...
2025-05-23 18:22:27,360 - {'epoch': 1, 'rec_loss': '8.0976'}
2025-05-23 18:22:40,189 - {'Epoch': 1, 'HR@5': '0.0245', 'NDCG@5': '0.0156', 'HR@10': '0.0420', 'NDCG@10': '0.0212', 'HR@20': '0.0694', 'NDCG@20': '0.0281'}
2025-05-23 18:22:40,191 - Validation score increased.  Saving model ...
2025-05-23 18:23:07,678 - {'epoch': 2, 'rec_loss': '7.5416'}
2025-05-23 18:23:20,224 - {'Epoch': 2, 'HR@5': '0.0305', 'NDCG@5': '0.0187', 'HR@10': '0.0497', 'NDCG@10': '0.0249', 'HR@20': '0.0782', 'NDCG@20': '0.0320'}
2025-05-23 18:23:20,227 - Validation score increased.  Saving model ...
2025-05-23 18:23:47,724 - {'epoch': 3, 'rec_loss': '7.0891'}
2025-05-23 18:24:00,155 - {'Epoch': 3, 'HR@5': '0.0306', 'NDCG@5': '0.0191', 'HR@10': '0.0517', 'NDCG@10': '0.0259', 'HR@20': '0.0827', 'NDCG@20': '0.0337'}
2025-05-23 18:24:00,156 - Validation score increased.  Saving model ...
2025-05-23 18:24:27,777 - {'epoch': 4, 'rec_loss': '6.7435'}
2025-05-23 18:24:40,646 - {'Epoch': 4, 'HR@5': '0.0289', 'NDCG@5': '0.0181', 'HR@10': '0.0501', 'NDCG@10': '0.0249', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-05-23 18:24:40,648 - EarlyStopping counter: 1 out of 10
2025-05-23 18:25:07,574 - {'epoch': 5, 'rec_loss': '6.5209'}
2025-05-23 18:25:20,564 - {'Epoch': 5, 'HR@5': '0.0294', 'NDCG@5': '0.0186', 'HR@10': '0.0492', 'NDCG@10': '0.0249', 'HR@20': '0.0797', 'NDCG@20': '0.0326'}
2025-05-23 18:25:20,565 - EarlyStopping counter: 2 out of 10
2025-05-23 18:25:47,485 - {'epoch': 6, 'rec_loss': '6.3821'}
2025-05-23 18:26:00,825 - {'Epoch': 6, 'HR@5': '0.0291', 'NDCG@5': '0.0182', 'HR@10': '0.0479', 'NDCG@10': '0.0242', 'HR@20': '0.0766', 'NDCG@20': '0.0315'}
2025-05-23 18:26:00,827 - EarlyStopping counter: 3 out of 10
2025-05-23 18:26:27,117 - {'epoch': 7, 'rec_loss': '6.2841'}
2025-05-23 18:26:40,676 - {'Epoch': 7, 'HR@5': '0.0284', 'NDCG@5': '0.0181', 'HR@10': '0.0469', 'NDCG@10': '0.0240', 'HR@20': '0.0775', 'NDCG@20': '0.0317'}
2025-05-23 18:26:40,677 - EarlyStopping counter: 4 out of 10
2025-05-23 18:27:07,204 - {'epoch': 8, 'rec_loss': '6.2116'}
2025-05-23 18:27:20,513 - {'Epoch': 8, 'HR@5': '0.0288', 'NDCG@5': '0.0181', 'HR@10': '0.0479', 'NDCG@10': '0.0242', 'HR@20': '0.0756', 'NDCG@20': '0.0311'}
2025-05-23 18:27:20,516 - EarlyStopping counter: 5 out of 10
2025-05-23 18:27:46,961 - {'epoch': 9, 'rec_loss': '6.1547'}
2025-05-23 18:28:00,157 - {'Epoch': 9, 'HR@5': '0.0282', 'NDCG@5': '0.0176', 'HR@10': '0.0466', 'NDCG@10': '0.0235', 'HR@20': '0.0753', 'NDCG@20': '0.0308'}
2025-05-23 18:28:00,158 - EarlyStopping counter: 6 out of 10
2025-05-23 18:28:26,777 - {'epoch': 10, 'rec_loss': '6.1014'}
2025-05-23 18:28:39,746 - {'Epoch': 10, 'HR@5': '0.0282', 'NDCG@5': '0.0178', 'HR@10': '0.0462', 'NDCG@10': '0.0235', 'HR@20': '0.0750', 'NDCG@20': '0.0307'}
2025-05-23 18:28:39,748 - EarlyStopping counter: 7 out of 10
2025-05-23 18:29:06,391 - {'epoch': 11, 'rec_loss': '6.0554'}
2025-05-23 18:29:19,061 - {'Epoch': 11, 'HR@5': '0.0273', 'NDCG@5': '0.0175', 'HR@10': '0.0463', 'NDCG@10': '0.0236', 'HR@20': '0.0742', 'NDCG@20': '0.0306'}
2025-05-23 18:29:19,063 - EarlyStopping counter: 8 out of 10
2025-05-23 18:29:45,863 - {'epoch': 12, 'rec_loss': '6.0096'}
2025-05-23 18:29:58,844 - {'Epoch': 12, 'HR@5': '0.0278', 'NDCG@5': '0.0173', 'HR@10': '0.0458', 'NDCG@10': '0.0231', 'HR@20': '0.0742', 'NDCG@20': '0.0302'}
2025-05-23 18:29:58,845 - EarlyStopping counter: 9 out of 10
2025-05-23 18:30:26,135 - {'epoch': 13, 'rec_loss': '5.9652'}
2025-05-23 18:30:38,791 - {'Epoch': 13, 'HR@5': '0.0272', 'NDCG@5': '0.0171', 'HR@10': '0.0451', 'NDCG@10': '0.0229', 'HR@20': '0.0721', 'NDCG@20': '0.0296'}
2025-05-23 18:30:38,792 - EarlyStopping counter: 10 out of 10
2025-05-23 18:30:38,793 - Early stopping
2025-05-23 18:30:38,793 - ---------------Test Score---------------
2025-05-23 18:30:51,473 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0186', 'HR@10': '0.0474', 'NDCG@10': '0.0245', 'HR@20': '0.0777', 'NDCG@20': '0.0321'}
2025-05-23 18:30:51,475 - TVRec_Yelp_best
2025-05-23 18:30:51,475 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0186', 'HR@10': '0.0474', 'NDCG@10': '0.0245', 'HR@20': '0.0777', 'NDCG@20': '0.0321'}
