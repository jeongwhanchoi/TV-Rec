2025-05-23 17:00:07,101 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='TVRec_LastFM_best', num_items=10, num_users=1091, save=True, lr=0.001, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=8, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='TVRec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.4, initializer_range=0.02, dt_min=0.0, dt_max=0.5, M=8, reg_weight=0.001, device='cuda', data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/TVRec_LastFM_best.pt')
2025-05-23 17:00:07,539 - TVRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.4, inplace=False)
  (item_encoder): NVRecEncoder(
    (blocks): ModuleList(
      (0-1): 2 x NVRecBlock(
        (layer): NVRecLayer(
          (out_dropout): Dropout(p=0.4, inplace=False)
          (LayerNorm): LayerNorm()
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.4, inplace=False)
        )
      )
    )
  )
)
2025-05-23 17:00:07,869 - Total Parameters: 303440
2025-05-23 17:00:11,356 - {'epoch': 0, 'rec_loss': '8.1006'}
2025-05-23 17:00:11,837 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0151', 'HR@10': '0.0339', 'NDCG@10': '0.0187', 'HR@20': '0.0550', 'NDCG@20': '0.0240'}
2025-05-23 17:00:11,838 - Validation score increased.  Saving model ...
2025-05-23 17:00:15,192 - {'epoch': 1, 'rec_loss': '7.6222'}
2025-05-23 17:00:15,781 - {'Epoch': 1, 'HR@5': '0.0294', 'NDCG@5': '0.0203', 'HR@10': '0.0459', 'NDCG@10': '0.0258', 'HR@20': '0.0752', 'NDCG@20': '0.0330'}
2025-05-23 17:00:15,782 - Validation score increased.  Saving model ...
2025-05-23 17:00:18,836 - {'epoch': 2, 'rec_loss': '7.2433'}
2025-05-23 17:00:19,355 - {'Epoch': 2, 'HR@5': '0.0330', 'NDCG@5': '0.0207', 'HR@10': '0.0560', 'NDCG@10': '0.0282', 'HR@20': '0.0945', 'NDCG@20': '0.0379'}
2025-05-23 17:00:19,357 - Validation score increased.  Saving model ...
2025-05-23 17:00:22,135 - {'epoch': 3, 'rec_loss': '6.8771'}
2025-05-23 17:00:22,591 - {'Epoch': 3, 'HR@5': '0.0440', 'NDCG@5': '0.0292', 'HR@10': '0.0661', 'NDCG@10': '0.0363', 'HR@20': '0.1046', 'NDCG@20': '0.0459'}
2025-05-23 17:00:22,593 - Validation score increased.  Saving model ...
2025-05-23 17:00:25,521 - {'epoch': 4, 'rec_loss': '6.5546'}
2025-05-23 17:00:26,017 - {'Epoch': 4, 'HR@5': '0.0477', 'NDCG@5': '0.0303', 'HR@10': '0.0725', 'NDCG@10': '0.0380', 'HR@20': '0.1055', 'NDCG@20': '0.0462'}
2025-05-23 17:00:26,019 - Validation score increased.  Saving model ...
2025-05-23 17:00:29,172 - {'epoch': 5, 'rec_loss': '6.2780'}
2025-05-23 17:00:29,639 - {'Epoch': 5, 'HR@5': '0.0550', 'NDCG@5': '0.0342', 'HR@10': '0.0752', 'NDCG@10': '0.0407', 'HR@20': '0.1174', 'NDCG@20': '0.0513'}
2025-05-23 17:00:29,641 - Validation score increased.  Saving model ...
2025-05-23 17:00:32,580 - {'epoch': 6, 'rec_loss': '6.0400'}
2025-05-23 17:00:33,069 - {'Epoch': 6, 'HR@5': '0.0532', 'NDCG@5': '0.0321', 'HR@10': '0.0862', 'NDCG@10': '0.0427', 'HR@20': '0.1284', 'NDCG@20': '0.0534'}
2025-05-23 17:00:33,073 - Validation score increased.  Saving model ...
2025-05-23 17:00:36,165 - {'epoch': 7, 'rec_loss': '5.8454'}
2025-05-23 17:00:36,624 - {'Epoch': 7, 'HR@5': '0.0587', 'NDCG@5': '0.0376', 'HR@10': '0.0890', 'NDCG@10': '0.0473', 'HR@20': '0.1321', 'NDCG@20': '0.0583'}
2025-05-23 17:00:36,626 - Validation score increased.  Saving model ...
2025-05-23 17:00:39,700 - {'epoch': 8, 'rec_loss': '5.6609'}
2025-05-23 17:00:40,165 - {'Epoch': 8, 'HR@5': '0.0560', 'NDCG@5': '0.0377', 'HR@10': '0.0982', 'NDCG@10': '0.0512', 'HR@20': '0.1422', 'NDCG@20': '0.0622'}
2025-05-23 17:00:40,167 - Validation score increased.  Saving model ...
2025-05-23 17:00:43,324 - {'epoch': 9, 'rec_loss': '5.5163'}
2025-05-23 17:00:43,839 - {'Epoch': 9, 'HR@5': '0.0596', 'NDCG@5': '0.0398', 'HR@10': '0.1028', 'NDCG@10': '0.0536', 'HR@20': '0.1486', 'NDCG@20': '0.0650'}
2025-05-23 17:00:43,841 - Validation score increased.  Saving model ...
2025-05-23 17:00:46,900 - {'epoch': 10, 'rec_loss': '5.3962'}
2025-05-23 17:00:47,411 - {'Epoch': 10, 'HR@5': '0.0679', 'NDCG@5': '0.0407', 'HR@10': '0.1000', 'NDCG@10': '0.0511', 'HR@20': '0.1523', 'NDCG@20': '0.0643'}
2025-05-23 17:00:47,412 - EarlyStopping counter: 1 out of 10
2025-05-23 17:00:50,604 - {'epoch': 11, 'rec_loss': '5.3034'}
2025-05-23 17:00:51,093 - {'Epoch': 11, 'HR@5': '0.0596', 'NDCG@5': '0.0385', 'HR@10': '0.1046', 'NDCG@10': '0.0530', 'HR@20': '0.1431', 'NDCG@20': '0.0629'}
2025-05-23 17:00:51,094 - EarlyStopping counter: 2 out of 10
2025-05-23 17:00:54,234 - {'epoch': 12, 'rec_loss': '5.2141'}
2025-05-23 17:00:54,703 - {'Epoch': 12, 'HR@5': '0.0615', 'NDCG@5': '0.0388', 'HR@10': '0.0936', 'NDCG@10': '0.0491', 'HR@20': '0.1413', 'NDCG@20': '0.0611'}
2025-05-23 17:00:54,705 - EarlyStopping counter: 3 out of 10
2025-05-23 17:00:57,801 - {'epoch': 13, 'rec_loss': '5.1422'}
2025-05-23 17:00:58,288 - {'Epoch': 13, 'HR@5': '0.0697', 'NDCG@5': '0.0427', 'HR@10': '0.1046', 'NDCG@10': '0.0539', 'HR@20': '0.1477', 'NDCG@20': '0.0648'}
2025-05-23 17:00:58,289 - EarlyStopping counter: 4 out of 10
2025-05-23 17:01:01,137 - {'epoch': 14, 'rec_loss': '5.0935'}
2025-05-23 17:01:01,600 - {'Epoch': 14, 'HR@5': '0.0624', 'NDCG@5': '0.0399', 'HR@10': '0.1028', 'NDCG@10': '0.0529', 'HR@20': '0.1486', 'NDCG@20': '0.0643'}
2025-05-23 17:01:01,601 - EarlyStopping counter: 5 out of 10
2025-05-23 17:01:04,393 - {'epoch': 15, 'rec_loss': '5.0365'}
2025-05-23 17:01:04,907 - {'Epoch': 15, 'HR@5': '0.0661', 'NDCG@5': '0.0406', 'HR@10': '0.0982', 'NDCG@10': '0.0508', 'HR@20': '0.1532', 'NDCG@20': '0.0648'}
2025-05-23 17:01:04,908 - EarlyStopping counter: 6 out of 10
2025-05-23 17:01:08,043 - {'epoch': 16, 'rec_loss': '4.9921'}
2025-05-23 17:01:08,542 - {'Epoch': 16, 'HR@5': '0.0670', 'NDCG@5': '0.0444', 'HR@10': '0.1083', 'NDCG@10': '0.0576', 'HR@20': '0.1486', 'NDCG@20': '0.0679'}
2025-05-23 17:01:08,543 - Validation score increased.  Saving model ...
2025-05-23 17:01:11,811 - {'epoch': 17, 'rec_loss': '4.9545'}
2025-05-23 17:01:12,289 - {'Epoch': 17, 'HR@5': '0.0642', 'NDCG@5': '0.0430', 'HR@10': '0.1009', 'NDCG@10': '0.0548', 'HR@20': '0.1477', 'NDCG@20': '0.0667'}
2025-05-23 17:01:12,290 - EarlyStopping counter: 1 out of 10
2025-05-23 17:01:15,282 - {'epoch': 18, 'rec_loss': '4.9153'}
2025-05-23 17:01:15,763 - {'Epoch': 18, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.1055', 'NDCG@10': '0.0542', 'HR@20': '0.1560', 'NDCG@20': '0.0667'}
2025-05-23 17:01:15,763 - EarlyStopping counter: 2 out of 10
2025-05-23 17:01:18,787 - {'epoch': 19, 'rec_loss': '4.8799'}
2025-05-23 17:01:19,300 - {'Epoch': 19, 'HR@5': '0.0661', 'NDCG@5': '0.0437', 'HR@10': '0.1064', 'NDCG@10': '0.0567', 'HR@20': '0.1413', 'NDCG@20': '0.0653'}
2025-05-23 17:01:19,301 - EarlyStopping counter: 3 out of 10
2025-05-23 17:01:22,448 - {'epoch': 20, 'rec_loss': '4.8600'}
2025-05-23 17:01:22,929 - {'Epoch': 20, 'HR@5': '0.0679', 'NDCG@5': '0.0431', 'HR@10': '0.1028', 'NDCG@10': '0.0544', 'HR@20': '0.1486', 'NDCG@20': '0.0660'}
2025-05-23 17:01:22,930 - EarlyStopping counter: 4 out of 10
2025-05-23 17:01:25,804 - {'epoch': 21, 'rec_loss': '4.8250'}
2025-05-23 17:01:26,249 - {'Epoch': 21, 'HR@5': '0.0661', 'NDCG@5': '0.0414', 'HR@10': '0.1037', 'NDCG@10': '0.0536', 'HR@20': '0.1495', 'NDCG@20': '0.0650'}
2025-05-23 17:01:26,250 - EarlyStopping counter: 5 out of 10
2025-05-23 17:01:29,344 - {'epoch': 22, 'rec_loss': '4.8076'}
2025-05-23 17:01:29,842 - {'Epoch': 22, 'HR@5': '0.0716', 'NDCG@5': '0.0459', 'HR@10': '0.1073', 'NDCG@10': '0.0573', 'HR@20': '0.1514', 'NDCG@20': '0.0685'}
2025-05-23 17:01:29,843 - Validation score increased.  Saving model ...
2025-05-23 17:01:32,916 - {'epoch': 23, 'rec_loss': '4.7575'}
2025-05-23 17:01:33,396 - {'Epoch': 23, 'HR@5': '0.0606', 'NDCG@5': '0.0378', 'HR@10': '0.1119', 'NDCG@10': '0.0543', 'HR@20': '0.1596', 'NDCG@20': '0.0662'}
2025-05-23 17:01:33,397 - EarlyStopping counter: 1 out of 10
2025-05-23 17:01:36,296 - {'epoch': 24, 'rec_loss': '4.7336'}
2025-05-23 17:01:36,832 - {'Epoch': 24, 'HR@5': '0.0661', 'NDCG@5': '0.0415', 'HR@10': '0.1092', 'NDCG@10': '0.0557', 'HR@20': '0.1523', 'NDCG@20': '0.0664'}
2025-05-23 17:01:36,833 - EarlyStopping counter: 2 out of 10
2025-05-23 17:01:39,948 - {'epoch': 25, 'rec_loss': '4.7211'}
2025-05-23 17:01:40,443 - {'Epoch': 25, 'HR@5': '0.0706', 'NDCG@5': '0.0444', 'HR@10': '0.1119', 'NDCG@10': '0.0576', 'HR@20': '0.1606', 'NDCG@20': '0.0699'}
2025-05-23 17:01:40,445 - Validation score increased.  Saving model ...
2025-05-23 17:01:43,687 - {'epoch': 26, 'rec_loss': '4.7165'}
2025-05-23 17:01:44,174 - {'Epoch': 26, 'HR@5': '0.0661', 'NDCG@5': '0.0425', 'HR@10': '0.1138', 'NDCG@10': '0.0576', 'HR@20': '0.1514', 'NDCG@20': '0.0669'}
2025-05-23 17:01:44,176 - EarlyStopping counter: 1 out of 10
2025-05-23 17:01:47,209 - {'epoch': 27, 'rec_loss': '4.6782'}
2025-05-23 17:01:47,658 - {'Epoch': 27, 'HR@5': '0.0743', 'NDCG@5': '0.0460', 'HR@10': '0.1101', 'NDCG@10': '0.0575', 'HR@20': '0.1495', 'NDCG@20': '0.0675'}
2025-05-23 17:01:47,659 - EarlyStopping counter: 2 out of 10
2025-05-23 17:01:50,743 - {'epoch': 28, 'rec_loss': '4.6596'}
2025-05-23 17:01:51,203 - {'Epoch': 28, 'HR@5': '0.0734', 'NDCG@5': '0.0491', 'HR@10': '0.1092', 'NDCG@10': '0.0604', 'HR@20': '0.1578', 'NDCG@20': '0.0727'}
2025-05-23 17:01:51,204 - Validation score increased.  Saving model ...
2025-05-23 17:01:54,341 - {'epoch': 29, 'rec_loss': '4.6450'}
2025-05-23 17:01:54,801 - {'Epoch': 29, 'HR@5': '0.0651', 'NDCG@5': '0.0422', 'HR@10': '0.1018', 'NDCG@10': '0.0539', 'HR@20': '0.1596', 'NDCG@20': '0.0686'}
2025-05-23 17:01:54,802 - EarlyStopping counter: 1 out of 10
2025-05-23 17:01:57,963 - {'epoch': 30, 'rec_loss': '4.6252'}
2025-05-23 17:01:58,426 - {'Epoch': 30, 'HR@5': '0.0688', 'NDCG@5': '0.0440', 'HR@10': '0.1046', 'NDCG@10': '0.0554', 'HR@20': '0.1587', 'NDCG@20': '0.0689'}
2025-05-23 17:01:58,427 - EarlyStopping counter: 2 out of 10
2025-05-23 17:02:01,501 - {'epoch': 31, 'rec_loss': '4.6022'}
2025-05-23 17:02:01,940 - {'Epoch': 31, 'HR@5': '0.0706', 'NDCG@5': '0.0441', 'HR@10': '0.1083', 'NDCG@10': '0.0562', 'HR@20': '0.1587', 'NDCG@20': '0.0690'}
2025-05-23 17:02:01,941 - EarlyStopping counter: 3 out of 10
2025-05-23 17:02:05,076 - {'epoch': 32, 'rec_loss': '4.5909'}
2025-05-23 17:02:05,533 - {'Epoch': 32, 'HR@5': '0.0615', 'NDCG@5': '0.0411', 'HR@10': '0.1037', 'NDCG@10': '0.0546', 'HR@20': '0.1624', 'NDCG@20': '0.0694'}
2025-05-23 17:02:05,534 - EarlyStopping counter: 4 out of 10
2025-05-23 17:02:08,651 - {'epoch': 33, 'rec_loss': '4.5693'}
2025-05-23 17:02:09,218 - {'Epoch': 33, 'HR@5': '0.0642', 'NDCG@5': '0.0425', 'HR@10': '0.1009', 'NDCG@10': '0.0541', 'HR@20': '0.1624', 'NDCG@20': '0.0695'}
2025-05-23 17:02:09,219 - EarlyStopping counter: 5 out of 10
2025-05-23 17:02:12,314 - {'epoch': 34, 'rec_loss': '4.5578'}
2025-05-23 17:02:12,776 - {'Epoch': 34, 'HR@5': '0.0615', 'NDCG@5': '0.0409', 'HR@10': '0.1018', 'NDCG@10': '0.0539', 'HR@20': '0.1569', 'NDCG@20': '0.0677'}
2025-05-23 17:02:12,777 - EarlyStopping counter: 6 out of 10
2025-05-23 17:02:15,887 - {'epoch': 35, 'rec_loss': '4.5426'}
2025-05-23 17:02:16,370 - {'Epoch': 35, 'HR@5': '0.0596', 'NDCG@5': '0.0394', 'HR@10': '0.1000', 'NDCG@10': '0.0523', 'HR@20': '0.1477', 'NDCG@20': '0.0645'}
2025-05-23 17:02:16,371 - EarlyStopping counter: 7 out of 10
2025-05-23 17:02:19,465 - {'epoch': 36, 'rec_loss': '4.5313'}
2025-05-23 17:02:19,921 - {'Epoch': 36, 'HR@5': '0.0670', 'NDCG@5': '0.0424', 'HR@10': '0.0982', 'NDCG@10': '0.0525', 'HR@20': '0.1514', 'NDCG@20': '0.0658'}
2025-05-23 17:02:19,923 - EarlyStopping counter: 8 out of 10
2025-05-23 17:02:22,634 - {'epoch': 37, 'rec_loss': '4.5107'}
2025-05-23 17:02:23,126 - {'Epoch': 37, 'HR@5': '0.0651', 'NDCG@5': '0.0421', 'HR@10': '0.0982', 'NDCG@10': '0.0527', 'HR@20': '0.1578', 'NDCG@20': '0.0675'}
2025-05-23 17:02:23,129 - EarlyStopping counter: 9 out of 10
2025-05-23 17:02:25,507 - {'epoch': 38, 'rec_loss': '4.5090'}
2025-05-23 17:02:25,960 - {'Epoch': 38, 'HR@5': '0.0651', 'NDCG@5': '0.0409', 'HR@10': '0.1028', 'NDCG@10': '0.0527', 'HR@20': '0.1523', 'NDCG@20': '0.0651'}
2025-05-23 17:02:25,961 - EarlyStopping counter: 10 out of 10
2025-05-23 17:02:25,961 - Early stopping
2025-05-23 17:02:25,961 - ---------------Test Score---------------
2025-05-23 17:02:26,378 - {'Epoch': 0, 'HR@5': '0.0596', 'NDCG@5': '0.0402', 'HR@10': '0.0853', 'NDCG@10': '0.0484', 'HR@20': '0.1202', 'NDCG@20': '0.0572'}
2025-05-23 17:02:26,379 - TVRec_LastFM_best
2025-05-23 17:02:26,379 - {'Epoch': 0, 'HR@5': '0.0596', 'NDCG@5': '0.0402', 'HR@10': '0.0853', 'NDCG@10': '0.0484', 'HR@20': '0.1202', 'NDCG@20': '0.0572'}
