2025-05-23 16:41:20,963 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='TVRec_Beauty_best', num_items=10, num_users=22364, save=True, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=8, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='TVRec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, dt_min=0.0, dt_max=0.5, M=32, reg_weight=0.0, device='cuda', data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/TVRec_Beauty_best.pt')
2025-05-23 16:41:21,453 - TVRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (item_encoder): NVRecEncoder(
    (blocks): ModuleList(
      (0-1): 2 x NVRecBlock(
        (layer): NVRecLayer(
          (out_dropout): Dropout(p=0.5, inplace=False)
          (LayerNorm): LayerNorm()
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2025-05-23 16:41:21,776 - Total Parameters: 854208
2025-05-23 16:41:36,490 - {'epoch': 0, 'rec_loss': '8.9437'}
2025-05-23 16:41:43,060 - {'Epoch': 0, 'HR@5': '0.0204', 'NDCG@5': '0.0131', 'HR@10': '0.0320', 'NDCG@10': '0.0168', 'HR@20': '0.0477', 'NDCG@20': '0.0207'}
2025-05-23 16:41:43,062 - Validation score increased.  Saving model ...
2025-05-23 16:41:57,491 - {'epoch': 1, 'rec_loss': '8.1881'}
2025-05-23 16:42:03,648 - {'Epoch': 1, 'HR@5': '0.0322', 'NDCG@5': '0.0206', 'HR@10': '0.0518', 'NDCG@10': '0.0269', 'HR@20': '0.0806', 'NDCG@20': '0.0341'}
2025-05-23 16:42:03,649 - Validation score increased.  Saving model ...
2025-05-23 16:42:18,245 - {'epoch': 2, 'rec_loss': '7.7935'}
2025-05-23 16:42:24,438 - {'Epoch': 2, 'HR@5': '0.0472', 'NDCG@5': '0.0307', 'HR@10': '0.0698', 'NDCG@10': '0.0379', 'HR@20': '0.1029', 'NDCG@20': '0.0462'}
2025-05-23 16:42:24,439 - Validation score increased.  Saving model ...
2025-05-23 16:42:38,936 - {'epoch': 3, 'rec_loss': '7.5230'}
2025-05-23 16:42:45,133 - {'Epoch': 3, 'HR@5': '0.0598', 'NDCG@5': '0.0396', 'HR@10': '0.0865', 'NDCG@10': '0.0482', 'HR@20': '0.1235', 'NDCG@20': '0.0575'}
2025-05-23 16:42:45,134 - Validation score increased.  Saving model ...
2025-05-23 16:42:59,506 - {'epoch': 4, 'rec_loss': '7.3128'}
2025-05-23 16:43:05,552 - {'Epoch': 4, 'HR@5': '0.0678', 'NDCG@5': '0.0458', 'HR@10': '0.0959', 'NDCG@10': '0.0549', 'HR@20': '0.1345', 'NDCG@20': '0.0646'}
2025-05-23 16:43:05,557 - Validation score increased.  Saving model ...
2025-05-23 16:43:19,943 - {'epoch': 5, 'rec_loss': '7.1355'}
2025-05-23 16:43:26,071 - {'Epoch': 5, 'HR@5': '0.0716', 'NDCG@5': '0.0487', 'HR@10': '0.1019', 'NDCG@10': '0.0584', 'HR@20': '0.1426', 'NDCG@20': '0.0686'}
2025-05-23 16:43:26,072 - Validation score increased.  Saving model ...
2025-05-23 16:43:39,979 - {'epoch': 6, 'rec_loss': '6.9821'}
2025-05-23 16:43:46,212 - {'Epoch': 6, 'HR@5': '0.0772', 'NDCG@5': '0.0532', 'HR@10': '0.1098', 'NDCG@10': '0.0638', 'HR@20': '0.1497', 'NDCG@20': '0.0738'}
2025-05-23 16:43:46,213 - Validation score increased.  Saving model ...
2025-05-23 16:44:00,139 - {'epoch': 7, 'rec_loss': '6.8546'}
2025-05-23 16:44:06,194 - {'Epoch': 7, 'HR@5': '0.0793', 'NDCG@5': '0.0557', 'HR@10': '0.1113', 'NDCG@10': '0.0660', 'HR@20': '0.1523', 'NDCG@20': '0.0763'}
2025-05-23 16:44:06,195 - Validation score increased.  Saving model ...
2025-05-23 16:44:20,380 - {'epoch': 8, 'rec_loss': '6.7355'}
2025-05-23 16:44:26,593 - {'Epoch': 8, 'HR@5': '0.0815', 'NDCG@5': '0.0569', 'HR@10': '0.1146', 'NDCG@10': '0.0676', 'HR@20': '0.1578', 'NDCG@20': '0.0784'}
2025-05-23 16:44:26,594 - Validation score increased.  Saving model ...
2025-05-23 16:44:40,974 - {'epoch': 9, 'rec_loss': '6.6535'}
2025-05-23 16:44:47,097 - {'Epoch': 9, 'HR@5': '0.0838', 'NDCG@5': '0.0589', 'HR@10': '0.1161', 'NDCG@10': '0.0692', 'HR@20': '0.1587', 'NDCG@20': '0.0800'}
2025-05-23 16:44:47,098 - Validation score increased.  Saving model ...
2025-05-23 16:45:01,669 - {'epoch': 10, 'rec_loss': '6.5758'}
2025-05-23 16:45:07,757 - {'Epoch': 10, 'HR@5': '0.0837', 'NDCG@5': '0.0583', 'HR@10': '0.1178', 'NDCG@10': '0.0693', 'HR@20': '0.1593', 'NDCG@20': '0.0798'}
2025-05-23 16:45:07,758 - EarlyStopping counter: 1 out of 10
2025-05-23 16:45:21,824 - {'epoch': 11, 'rec_loss': '6.5144'}
2025-05-23 16:45:27,947 - {'Epoch': 11, 'HR@5': '0.0847', 'NDCG@5': '0.0594', 'HR@10': '0.1170', 'NDCG@10': '0.0697', 'HR@20': '0.1604', 'NDCG@20': '0.0806'}
2025-05-23 16:45:27,948 - Validation score increased.  Saving model ...
2025-05-23 16:45:42,360 - {'epoch': 12, 'rec_loss': '6.4642'}
2025-05-23 16:45:48,533 - {'Epoch': 12, 'HR@5': '0.0846', 'NDCG@5': '0.0594', 'HR@10': '0.1176', 'NDCG@10': '0.0700', 'HR@20': '0.1604', 'NDCG@20': '0.0808'}
2025-05-23 16:45:48,534 - Validation score increased.  Saving model ...
2025-05-23 16:46:02,750 - {'epoch': 13, 'rec_loss': '6.4210'}
2025-05-23 16:46:08,905 - {'Epoch': 13, 'HR@5': '0.0861', 'NDCG@5': '0.0600', 'HR@10': '0.1177', 'NDCG@10': '0.0702', 'HR@20': '0.1588', 'NDCG@20': '0.0806'}
2025-05-23 16:46:08,906 - EarlyStopping counter: 1 out of 10
2025-05-23 16:46:22,566 - {'epoch': 14, 'rec_loss': '6.3970'}
2025-05-23 16:46:28,673 - {'Epoch': 14, 'HR@5': '0.0853', 'NDCG@5': '0.0600', 'HR@10': '0.1182', 'NDCG@10': '0.0706', 'HR@20': '0.1614', 'NDCG@20': '0.0815'}
2025-05-23 16:46:28,675 - Validation score increased.  Saving model ...
2025-05-23 16:46:43,031 - {'epoch': 15, 'rec_loss': '6.3549'}
2025-05-23 16:46:49,145 - {'Epoch': 15, 'HR@5': '0.0837', 'NDCG@5': '0.0589', 'HR@10': '0.1176', 'NDCG@10': '0.0697', 'HR@20': '0.1622', 'NDCG@20': '0.0810'}
2025-05-23 16:46:49,146 - EarlyStopping counter: 1 out of 10
2025-05-23 16:47:03,502 - {'epoch': 16, 'rec_loss': '6.3385'}
2025-05-23 16:47:09,752 - {'Epoch': 16, 'HR@5': '0.0846', 'NDCG@5': '0.0591', 'HR@10': '0.1189', 'NDCG@10': '0.0701', 'HR@20': '0.1626', 'NDCG@20': '0.0811'}
2025-05-23 16:47:09,753 - EarlyStopping counter: 2 out of 10
2025-05-23 16:47:24,404 - {'epoch': 17, 'rec_loss': '6.3132'}
2025-05-23 16:47:30,458 - {'Epoch': 17, 'HR@5': '0.0861', 'NDCG@5': '0.0604', 'HR@10': '0.1195', 'NDCG@10': '0.0712', 'HR@20': '0.1618', 'NDCG@20': '0.0818'}
2025-05-23 16:47:30,463 - Validation score increased.  Saving model ...
2025-05-23 16:47:44,915 - {'epoch': 18, 'rec_loss': '6.2963'}
2025-05-23 16:47:51,143 - {'Epoch': 18, 'HR@5': '0.0868', 'NDCG@5': '0.0607', 'HR@10': '0.1191', 'NDCG@10': '0.0712', 'HR@20': '0.1605', 'NDCG@20': '0.0816'}
2025-05-23 16:47:51,144 - EarlyStopping counter: 1 out of 10
2025-05-23 16:48:05,654 - {'epoch': 19, 'rec_loss': '6.2762'}
2025-05-23 16:48:11,793 - {'Epoch': 19, 'HR@5': '0.0851', 'NDCG@5': '0.0599', 'HR@10': '0.1205', 'NDCG@10': '0.0714', 'HR@20': '0.1632', 'NDCG@20': '0.0821'}
2025-05-23 16:48:11,795 - Validation score increased.  Saving model ...
2025-05-23 16:48:26,120 - {'epoch': 20, 'rec_loss': '6.2596'}
2025-05-23 16:48:32,227 - {'Epoch': 20, 'HR@5': '0.0855', 'NDCG@5': '0.0603', 'HR@10': '0.1195', 'NDCG@10': '0.0713', 'HR@20': '0.1626', 'NDCG@20': '0.0822'}
2025-05-23 16:48:32,228 - Validation score increased.  Saving model ...
2025-05-23 16:48:46,623 - {'epoch': 21, 'rec_loss': '6.2483'}
2025-05-23 16:48:52,846 - {'Epoch': 21, 'HR@5': '0.0850', 'NDCG@5': '0.0600', 'HR@10': '0.1198', 'NDCG@10': '0.0712', 'HR@20': '0.1612', 'NDCG@20': '0.0817'}
2025-05-23 16:48:52,848 - EarlyStopping counter: 1 out of 10
2025-05-23 16:49:07,301 - {'epoch': 22, 'rec_loss': '6.2337'}
2025-05-23 16:49:13,429 - {'Epoch': 22, 'HR@5': '0.0858', 'NDCG@5': '0.0604', 'HR@10': '0.1199', 'NDCG@10': '0.0714', 'HR@20': '0.1627', 'NDCG@20': '0.0822'}
2025-05-23 16:49:13,430 - Validation score increased.  Saving model ...
2025-05-23 16:49:27,735 - {'epoch': 23, 'rec_loss': '6.2232'}
2025-05-23 16:49:33,807 - {'Epoch': 23, 'HR@5': '0.0862', 'NDCG@5': '0.0609', 'HR@10': '0.1187', 'NDCG@10': '0.0715', 'HR@20': '0.1640', 'NDCG@20': '0.0829'}
2025-05-23 16:49:33,808 - Validation score increased.  Saving model ...
2025-05-23 16:49:48,143 - {'epoch': 24, 'rec_loss': '6.2150'}
2025-05-23 16:49:54,324 - {'Epoch': 24, 'HR@5': '0.0872', 'NDCG@5': '0.0612', 'HR@10': '0.1207', 'NDCG@10': '0.0720', 'HR@20': '0.1638', 'NDCG@20': '0.0828'}
2025-05-23 16:49:54,325 - EarlyStopping counter: 1 out of 10
2025-05-23 16:50:08,905 - {'epoch': 25, 'rec_loss': '6.1964'}
2025-05-23 16:50:15,111 - {'Epoch': 25, 'HR@5': '0.0859', 'NDCG@5': '0.0599', 'HR@10': '0.1189', 'NDCG@10': '0.0706', 'HR@20': '0.1621', 'NDCG@20': '0.0814'}
2025-05-23 16:50:15,113 - EarlyStopping counter: 2 out of 10
2025-05-23 16:50:29,356 - {'epoch': 26, 'rec_loss': '6.1886'}
2025-05-23 16:50:35,521 - {'Epoch': 26, 'HR@5': '0.0868', 'NDCG@5': '0.0610', 'HR@10': '0.1204', 'NDCG@10': '0.0719', 'HR@20': '0.1632', 'NDCG@20': '0.0827'}
2025-05-23 16:50:35,523 - EarlyStopping counter: 3 out of 10
2025-05-23 16:50:49,729 - {'epoch': 27, 'rec_loss': '6.1768'}
2025-05-23 16:50:55,925 - {'Epoch': 27, 'HR@5': '0.0871', 'NDCG@5': '0.0612', 'HR@10': '0.1198', 'NDCG@10': '0.0717', 'HR@20': '0.1643', 'NDCG@20': '0.0830'}
2025-05-23 16:50:55,928 - Validation score increased.  Saving model ...
2025-05-23 16:51:10,494 - {'epoch': 28, 'rec_loss': '6.1677'}
2025-05-23 16:51:16,752 - {'Epoch': 28, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1203', 'NDCG@10': '0.0724', 'HR@20': '0.1639', 'NDCG@20': '0.0834'}
2025-05-23 16:51:16,753 - Validation score increased.  Saving model ...
2025-05-23 16:51:31,216 - {'epoch': 29, 'rec_loss': '6.1600'}
2025-05-23 16:51:37,570 - {'Epoch': 29, 'HR@5': '0.0883', 'NDCG@5': '0.0615', 'HR@10': '0.1224', 'NDCG@10': '0.0725', 'HR@20': '0.1662', 'NDCG@20': '0.0835'}
2025-05-23 16:51:37,571 - Validation score increased.  Saving model ...
2025-05-23 16:51:51,981 - {'epoch': 30, 'rec_loss': '6.1518'}
2025-05-23 16:51:58,123 - {'Epoch': 30, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1212', 'NDCG@10': '0.0722', 'HR@20': '0.1635', 'NDCG@20': '0.0829'}
2025-05-23 16:51:58,124 - EarlyStopping counter: 1 out of 10
2025-05-23 16:52:12,603 - {'epoch': 31, 'rec_loss': '6.1412'}
2025-05-23 16:52:18,959 - {'Epoch': 31, 'HR@5': '0.0879', 'NDCG@5': '0.0623', 'HR@10': '0.1226', 'NDCG@10': '0.0735', 'HR@20': '0.1652', 'NDCG@20': '0.0842'}
2025-05-23 16:52:18,963 - Validation score increased.  Saving model ...
2025-05-23 16:52:33,544 - {'epoch': 32, 'rec_loss': '6.1320'}
2025-05-23 16:52:39,828 - {'Epoch': 32, 'HR@5': '0.0876', 'NDCG@5': '0.0612', 'HR@10': '0.1212', 'NDCG@10': '0.0721', 'HR@20': '0.1634', 'NDCG@20': '0.0827'}
2025-05-23 16:52:39,833 - EarlyStopping counter: 1 out of 10
2025-05-23 16:52:54,599 - {'epoch': 33, 'rec_loss': '6.1304'}
2025-05-23 16:53:00,812 - {'Epoch': 33, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1216', 'NDCG@10': '0.0728', 'HR@20': '0.1663', 'NDCG@20': '0.0841'}
2025-05-23 16:53:00,814 - EarlyStopping counter: 2 out of 10
2025-05-23 16:53:15,010 - {'epoch': 34, 'rec_loss': '6.1209'}
2025-05-23 16:53:21,252 - {'Epoch': 34, 'HR@5': '0.0890', 'NDCG@5': '0.0621', 'HR@10': '0.1221', 'NDCG@10': '0.0727', 'HR@20': '0.1666', 'NDCG@20': '0.0839'}
2025-05-23 16:53:21,253 - EarlyStopping counter: 3 out of 10
2025-05-23 16:53:35,860 - {'epoch': 35, 'rec_loss': '6.1189'}
2025-05-23 16:53:42,173 - {'Epoch': 35, 'HR@5': '0.0879', 'NDCG@5': '0.0614', 'HR@10': '0.1206', 'NDCG@10': '0.0720', 'HR@20': '0.1637', 'NDCG@20': '0.0828'}
2025-05-23 16:53:42,174 - EarlyStopping counter: 4 out of 10
2025-05-23 16:53:56,851 - {'epoch': 36, 'rec_loss': '6.1117'}
2025-05-23 16:54:03,061 - {'Epoch': 36, 'HR@5': '0.0880', 'NDCG@5': '0.0616', 'HR@10': '0.1222', 'NDCG@10': '0.0726', 'HR@20': '0.1632', 'NDCG@20': '0.0829'}
2025-05-23 16:54:03,062 - EarlyStopping counter: 5 out of 10
2025-05-23 16:54:17,670 - {'epoch': 37, 'rec_loss': '6.1039'}
2025-05-23 16:54:24,014 - {'Epoch': 37, 'HR@5': '0.0872', 'NDCG@5': '0.0613', 'HR@10': '0.1221', 'NDCG@10': '0.0726', 'HR@20': '0.1635', 'NDCG@20': '0.0830'}
2025-05-23 16:54:24,015 - EarlyStopping counter: 6 out of 10
2025-05-23 16:54:38,383 - {'epoch': 38, 'rec_loss': '6.0993'}
2025-05-23 16:54:44,556 - {'Epoch': 38, 'HR@5': '0.0876', 'NDCG@5': '0.0614', 'HR@10': '0.1219', 'NDCG@10': '0.0724', 'HR@20': '0.1639', 'NDCG@20': '0.0830'}
2025-05-23 16:54:44,557 - EarlyStopping counter: 7 out of 10
2025-05-23 16:54:59,349 - {'epoch': 39, 'rec_loss': '6.0929'}
2025-05-23 16:55:05,555 - {'Epoch': 39, 'HR@5': '0.0875', 'NDCG@5': '0.0608', 'HR@10': '0.1205', 'NDCG@10': '0.0714', 'HR@20': '0.1648', 'NDCG@20': '0.0826'}
2025-05-23 16:55:05,556 - EarlyStopping counter: 8 out of 10
2025-05-23 16:55:20,089 - {'epoch': 40, 'rec_loss': '6.0860'}
2025-05-23 16:55:26,344 - {'Epoch': 40, 'HR@5': '0.0887', 'NDCG@5': '0.0623', 'HR@10': '0.1216', 'NDCG@10': '0.0730', 'HR@20': '0.1637', 'NDCG@20': '0.0836'}
2025-05-23 16:55:26,345 - EarlyStopping counter: 9 out of 10
2025-05-23 16:55:41,466 - {'epoch': 41, 'rec_loss': '6.0760'}
2025-05-23 16:55:47,760 - {'Epoch': 41, 'HR@5': '0.0874', 'NDCG@5': '0.0608', 'HR@10': '0.1213', 'NDCG@10': '0.0718', 'HR@20': '0.1656', 'NDCG@20': '0.0829'}
2025-05-23 16:55:47,762 - EarlyStopping counter: 10 out of 10
2025-05-23 16:55:47,763 - Early stopping
2025-05-23 16:55:47,763 - ---------------Test Score---------------
2025-05-23 16:55:53,640 - {'Epoch': 0, 'HR@5': '0.0721', 'NDCG@5': '0.0513', 'HR@10': '0.1017', 'NDCG@10': '0.0608', 'HR@20': '0.1403', 'NDCG@20': '0.0705'}
2025-05-23 16:55:53,641 - TVRec_Beauty_best
2025-05-23 16:55:53,641 - {'Epoch': 0, 'HR@5': '0.0721', 'NDCG@5': '0.0513', 'HR@10': '0.1017', 'NDCG@10': '0.0608', 'HR@20': '0.1403', 'NDCG@20': '0.0705'}
