2025-05-23 18:21:32,096 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports', do_eval=False, load_model=None, train_name='TVRec_Sports_best', num_items=10, num_users=35599, save=True, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=8, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='TVRec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, dt_min=0.0, dt_max=0.5, M=16, reg_weight=0.0, device='cuda', data_file='./data/Sports.txt', item_size=18358, checkpoint_path='output/TVRec_Sports_best.pt')
2025-05-23 18:21:32,657 - TVRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (item_encoder): NVRecEncoder(
    (blocks): ModuleList(
      (0-1): 2 x NVRecBlock(
        (layer): NVRecLayer(
          (out_dropout): Dropout(p=0.5, inplace=False)
          (LayerNorm): LayerNorm()
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2025-05-23 18:21:33,137 - Total Parameters: 1248160
2025-05-23 18:21:56,685 - {'epoch': 0, 'rec_loss': '9.4511'}
2025-05-23 18:22:09,466 - {'Epoch': 0, 'HR@5': '0.0109', 'NDCG@5': '0.0068', 'HR@10': '0.0188', 'NDCG@10': '0.0093', 'HR@20': '0.0313', 'NDCG@20': '0.0124'}
2025-05-23 18:22:09,468 - Validation score increased.  Saving model ...
2025-05-23 18:22:33,111 - {'epoch': 1, 'rec_loss': '8.9314'}
2025-05-23 18:22:46,084 - {'Epoch': 1, 'HR@5': '0.0195', 'NDCG@5': '0.0124', 'HR@10': '0.0314', 'NDCG@10': '0.0162', 'HR@20': '0.0499', 'NDCG@20': '0.0208'}
2025-05-23 18:22:46,086 - Validation score increased.  Saving model ...
2025-05-23 18:23:09,910 - {'epoch': 2, 'rec_loss': '8.5863'}
2025-05-23 18:23:23,251 - {'Epoch': 2, 'HR@5': '0.0279', 'NDCG@5': '0.0178', 'HR@10': '0.0443', 'NDCG@10': '0.0231', 'HR@20': '0.0649', 'NDCG@20': '0.0282'}
2025-05-23 18:23:23,253 - Validation score increased.  Saving model ...
2025-05-23 18:23:47,232 - {'epoch': 3, 'rec_loss': '8.3325'}
2025-05-23 18:23:59,867 - {'Epoch': 3, 'HR@5': '0.0347', 'NDCG@5': '0.0230', 'HR@10': '0.0517', 'NDCG@10': '0.0285', 'HR@20': '0.0752', 'NDCG@20': '0.0344'}
2025-05-23 18:23:59,868 - Validation score increased.  Saving model ...
2025-05-23 18:24:23,648 - {'epoch': 4, 'rec_loss': '8.1190'}
2025-05-23 18:24:36,965 - {'Epoch': 4, 'HR@5': '0.0399', 'NDCG@5': '0.0267', 'HR@10': '0.0587', 'NDCG@10': '0.0327', 'HR@20': '0.0849', 'NDCG@20': '0.0393'}
2025-05-23 18:24:36,966 - Validation score increased.  Saving model ...
2025-05-23 18:25:00,472 - {'epoch': 5, 'rec_loss': '7.9390'}
2025-05-23 18:25:14,001 - {'Epoch': 5, 'HR@5': '0.0436', 'NDCG@5': '0.0295', 'HR@10': '0.0646', 'NDCG@10': '0.0363', 'HR@20': '0.0925', 'NDCG@20': '0.0433'}
2025-05-23 18:25:14,002 - Validation score increased.  Saving model ...
2025-05-23 18:25:37,362 - {'epoch': 6, 'rec_loss': '7.7831'}
2025-05-23 18:25:50,929 - {'Epoch': 6, 'HR@5': '0.0440', 'NDCG@5': '0.0301', 'HR@10': '0.0659', 'NDCG@10': '0.0371', 'HR@20': '0.0944', 'NDCG@20': '0.0443'}
2025-05-23 18:25:50,931 - Validation score increased.  Saving model ...
2025-05-23 18:26:13,948 - {'epoch': 7, 'rec_loss': '7.6492'}
2025-05-23 18:26:27,895 - {'Epoch': 7, 'HR@5': '0.0471', 'NDCG@5': '0.0326', 'HR@10': '0.0689', 'NDCG@10': '0.0396', 'HR@20': '0.0982', 'NDCG@20': '0.0470'}
2025-05-23 18:26:27,896 - Validation score increased.  Saving model ...
2025-05-23 18:26:50,432 - {'epoch': 8, 'rec_loss': '7.5393'}
2025-05-23 18:27:04,604 - {'Epoch': 8, 'HR@5': '0.0476', 'NDCG@5': '0.0330', 'HR@10': '0.0695', 'NDCG@10': '0.0400', 'HR@20': '0.0984', 'NDCG@20': '0.0473'}
2025-05-23 18:27:04,605 - Validation score increased.  Saving model ...
2025-05-23 18:27:27,041 - {'epoch': 9, 'rec_loss': '7.4489'}
2025-05-23 18:27:41,279 - {'Epoch': 9, 'HR@5': '0.0492', 'NDCG@5': '0.0340', 'HR@10': '0.0698', 'NDCG@10': '0.0406', 'HR@20': '0.1007', 'NDCG@20': '0.0484'}
2025-05-23 18:27:41,281 - Validation score increased.  Saving model ...
2025-05-23 18:28:02,999 - {'epoch': 10, 'rec_loss': '7.3804'}
2025-05-23 18:28:16,715 - {'Epoch': 10, 'HR@5': '0.0501', 'NDCG@5': '0.0342', 'HR@10': '0.0721', 'NDCG@10': '0.0413', 'HR@20': '0.1010', 'NDCG@20': '0.0486'}
2025-05-23 18:28:16,716 - Validation score increased.  Saving model ...
2025-05-23 18:28:38,541 - {'epoch': 11, 'rec_loss': '7.3179'}
2025-05-23 18:28:51,875 - {'Epoch': 11, 'HR@5': '0.0495', 'NDCG@5': '0.0339', 'HR@10': '0.0719', 'NDCG@10': '0.0411', 'HR@20': '0.1011', 'NDCG@20': '0.0485'}
2025-05-23 18:28:51,876 - EarlyStopping counter: 1 out of 10
2025-05-23 18:29:14,267 - {'epoch': 12, 'rec_loss': '7.2689'}
2025-05-23 18:29:28,320 - {'Epoch': 12, 'HR@5': '0.0499', 'NDCG@5': '0.0343', 'HR@10': '0.0705', 'NDCG@10': '0.0409', 'HR@20': '0.1013', 'NDCG@20': '0.0486'}
2025-05-23 18:29:28,322 - Validation score increased.  Saving model ...
2025-05-23 18:29:51,408 - {'epoch': 13, 'rec_loss': '7.2300'}
2025-05-23 18:30:05,097 - {'Epoch': 13, 'HR@5': '0.0500', 'NDCG@5': '0.0342', 'HR@10': '0.0717', 'NDCG@10': '0.0412', 'HR@20': '0.1012', 'NDCG@20': '0.0486'}
2025-05-23 18:30:05,099 - EarlyStopping counter: 1 out of 10
2025-05-23 18:30:28,469 - {'epoch': 14, 'rec_loss': '7.1934'}
2025-05-23 18:30:41,497 - {'Epoch': 14, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0718', 'NDCG@10': '0.0417', 'HR@20': '0.1015', 'NDCG@20': '0.0491'}
2025-05-23 18:30:41,499 - Validation score increased.  Saving model ...
2025-05-23 18:31:02,627 - {'epoch': 15, 'rec_loss': '7.1685'}
2025-05-23 18:31:16,201 - {'Epoch': 15, 'HR@5': '0.0500', 'NDCG@5': '0.0338', 'HR@10': '0.0721', 'NDCG@10': '0.0410', 'HR@20': '0.1009', 'NDCG@20': '0.0482'}
2025-05-23 18:31:16,202 - EarlyStopping counter: 1 out of 10
2025-05-23 18:31:36,775 - {'epoch': 16, 'rec_loss': '7.1391'}
2025-05-23 18:31:50,294 - {'Epoch': 16, 'HR@5': '0.0509', 'NDCG@5': '0.0347', 'HR@10': '0.0727', 'NDCG@10': '0.0417', 'HR@20': '0.1015', 'NDCG@20': '0.0489'}
2025-05-23 18:31:50,296 - EarlyStopping counter: 2 out of 10
2025-05-23 18:32:10,646 - {'epoch': 17, 'rec_loss': '7.1117'}
2025-05-23 18:32:24,287 - {'Epoch': 17, 'HR@5': '0.0484', 'NDCG@5': '0.0332', 'HR@10': '0.0709', 'NDCG@10': '0.0404', 'HR@20': '0.1021', 'NDCG@20': '0.0483'}
2025-05-23 18:32:24,288 - EarlyStopping counter: 3 out of 10
2025-05-23 18:32:44,863 - {'epoch': 18, 'rec_loss': '7.0901'}
2025-05-23 18:32:58,590 - {'Epoch': 18, 'HR@5': '0.0498', 'NDCG@5': '0.0341', 'HR@10': '0.0733', 'NDCG@10': '0.0417', 'HR@20': '0.1030', 'NDCG@20': '0.0492'}
2025-05-23 18:32:58,591 - Validation score increased.  Saving model ...
2025-05-23 18:33:18,964 - {'epoch': 19, 'rec_loss': '7.0739'}
2025-05-23 18:33:32,574 - {'Epoch': 19, 'HR@5': '0.0508', 'NDCG@5': '0.0348', 'HR@10': '0.0731', 'NDCG@10': '0.0420', 'HR@20': '0.1027', 'NDCG@20': '0.0494'}
2025-05-23 18:33:32,575 - Validation score increased.  Saving model ...
2025-05-23 18:33:53,209 - {'epoch': 20, 'rec_loss': '7.0557'}
2025-05-23 18:34:06,869 - {'Epoch': 20, 'HR@5': '0.0499', 'NDCG@5': '0.0341', 'HR@10': '0.0719', 'NDCG@10': '0.0412', 'HR@20': '0.1015', 'NDCG@20': '0.0486'}
2025-05-23 18:34:06,870 - EarlyStopping counter: 1 out of 10
2025-05-23 18:34:27,263 - {'epoch': 21, 'rec_loss': '7.0368'}
2025-05-23 18:34:40,975 - {'Epoch': 21, 'HR@5': '0.0498', 'NDCG@5': '0.0342', 'HR@10': '0.0723', 'NDCG@10': '0.0414', 'HR@20': '0.1024', 'NDCG@20': '0.0490'}
2025-05-23 18:34:40,977 - EarlyStopping counter: 2 out of 10
2025-05-23 18:35:01,516 - {'epoch': 22, 'rec_loss': '7.0242'}
2025-05-23 18:35:15,057 - {'Epoch': 22, 'HR@5': '0.0494', 'NDCG@5': '0.0341', 'HR@10': '0.0724', 'NDCG@10': '0.0415', 'HR@20': '0.1024', 'NDCG@20': '0.0490'}
2025-05-23 18:35:15,058 - EarlyStopping counter: 3 out of 10
2025-05-23 18:35:35,703 - {'epoch': 23, 'rec_loss': '7.0118'}
2025-05-23 18:35:49,279 - {'Epoch': 23, 'HR@5': '0.0501', 'NDCG@5': '0.0346', 'HR@10': '0.0725', 'NDCG@10': '0.0418', 'HR@20': '0.1026', 'NDCG@20': '0.0494'}
2025-05-23 18:35:49,283 - EarlyStopping counter: 4 out of 10
2025-05-23 18:36:09,908 - {'epoch': 24, 'rec_loss': '6.9998'}
2025-05-23 18:36:23,403 - {'Epoch': 24, 'HR@5': '0.0499', 'NDCG@5': '0.0343', 'HR@10': '0.0728', 'NDCG@10': '0.0417', 'HR@20': '0.1029', 'NDCG@20': '0.0492'}
2025-05-23 18:36:23,404 - EarlyStopping counter: 5 out of 10
2025-05-23 18:36:44,511 - {'epoch': 25, 'rec_loss': '6.9901'}
2025-05-23 18:36:58,135 - {'Epoch': 25, 'HR@5': '0.0507', 'NDCG@5': '0.0342', 'HR@10': '0.0732', 'NDCG@10': '0.0414', 'HR@20': '0.1030', 'NDCG@20': '0.0489'}
2025-05-23 18:36:58,136 - EarlyStopping counter: 6 out of 10
2025-05-23 18:37:18,382 - {'epoch': 26, 'rec_loss': '6.9752'}
2025-05-23 18:37:31,995 - {'Epoch': 26, 'HR@5': '0.0497', 'NDCG@5': '0.0343', 'HR@10': '0.0722', 'NDCG@10': '0.0415', 'HR@20': '0.1029', 'NDCG@20': '0.0492'}
2025-05-23 18:37:31,997 - EarlyStopping counter: 7 out of 10
2025-05-23 18:37:52,659 - {'epoch': 27, 'rec_loss': '6.9659'}
2025-05-23 18:38:06,077 - {'Epoch': 27, 'HR@5': '0.0506', 'NDCG@5': '0.0347', 'HR@10': '0.0736', 'NDCG@10': '0.0421', 'HR@20': '0.1035', 'NDCG@20': '0.0496'}
2025-05-23 18:38:06,081 - Validation score increased.  Saving model ...
2025-05-23 18:38:26,734 - {'epoch': 28, 'rec_loss': '6.9612'}
2025-05-23 18:38:40,237 - {'Epoch': 28, 'HR@5': '0.0498', 'NDCG@5': '0.0342', 'HR@10': '0.0730', 'NDCG@10': '0.0417', 'HR@20': '0.1032', 'NDCG@20': '0.0493'}
2025-05-23 18:38:40,242 - EarlyStopping counter: 1 out of 10
2025-05-23 18:39:00,964 - {'epoch': 29, 'rec_loss': '6.9496'}
2025-05-23 18:39:14,644 - {'Epoch': 29, 'HR@5': '0.0507', 'NDCG@5': '0.0347', 'HR@10': '0.0729', 'NDCG@10': '0.0418', 'HR@20': '0.1035', 'NDCG@20': '0.0495'}
2025-05-23 18:39:14,645 - EarlyStopping counter: 2 out of 10
2025-05-23 18:39:35,376 - {'epoch': 30, 'rec_loss': '6.9392'}
2025-05-23 18:39:49,090 - {'Epoch': 30, 'HR@5': '0.0495', 'NDCG@5': '0.0338', 'HR@10': '0.0717', 'NDCG@10': '0.0409', 'HR@20': '0.1021', 'NDCG@20': '0.0486'}
2025-05-23 18:39:49,091 - EarlyStopping counter: 3 out of 10
2025-05-23 18:40:10,210 - {'epoch': 31, 'rec_loss': '6.9286'}
2025-05-23 18:40:24,065 - {'Epoch': 31, 'HR@5': '0.0497', 'NDCG@5': '0.0339', 'HR@10': '0.0733', 'NDCG@10': '0.0415', 'HR@20': '0.1026', 'NDCG@20': '0.0488'}
2025-05-23 18:40:24,067 - EarlyStopping counter: 4 out of 10
2025-05-23 18:40:44,722 - {'epoch': 32, 'rec_loss': '6.9226'}
2025-05-23 18:40:58,344 - {'Epoch': 32, 'HR@5': '0.0498', 'NDCG@5': '0.0342', 'HR@10': '0.0718', 'NDCG@10': '0.0413', 'HR@20': '0.1022', 'NDCG@20': '0.0489'}
2025-05-23 18:40:58,346 - EarlyStopping counter: 5 out of 10
2025-05-23 18:41:18,584 - {'epoch': 33, 'rec_loss': '6.9183'}
2025-05-23 18:41:32,459 - {'Epoch': 33, 'HR@5': '0.0493', 'NDCG@5': '0.0337', 'HR@10': '0.0719', 'NDCG@10': '0.0410', 'HR@20': '0.1024', 'NDCG@20': '0.0486'}
2025-05-23 18:41:32,460 - EarlyStopping counter: 6 out of 10
2025-05-23 18:41:52,879 - {'epoch': 34, 'rec_loss': '6.9095'}
2025-05-23 18:42:06,555 - {'Epoch': 34, 'HR@5': '0.0497', 'NDCG@5': '0.0341', 'HR@10': '0.0720', 'NDCG@10': '0.0413', 'HR@20': '0.1031', 'NDCG@20': '0.0491'}
2025-05-23 18:42:06,556 - EarlyStopping counter: 7 out of 10
2025-05-23 18:42:27,202 - {'epoch': 35, 'rec_loss': '6.9043'}
2025-05-23 18:42:40,618 - {'Epoch': 35, 'HR@5': '0.0495', 'NDCG@5': '0.0340', 'HR@10': '0.0718', 'NDCG@10': '0.0412', 'HR@20': '0.1027', 'NDCG@20': '0.0490'}
2025-05-23 18:42:40,622 - EarlyStopping counter: 8 out of 10
2025-05-23 18:43:01,083 - {'epoch': 36, 'rec_loss': '6.8950'}
2025-05-23 18:43:14,592 - {'Epoch': 36, 'HR@5': '0.0503', 'NDCG@5': '0.0344', 'HR@10': '0.0740', 'NDCG@10': '0.0421', 'HR@20': '0.1044', 'NDCG@20': '0.0497'}
2025-05-23 18:43:14,593 - Validation score increased.  Saving model ...
2025-05-23 18:43:35,285 - {'epoch': 37, 'rec_loss': '6.8937'}
2025-05-23 18:43:49,106 - {'Epoch': 37, 'HR@5': '0.0490', 'NDCG@5': '0.0335', 'HR@10': '0.0711', 'NDCG@10': '0.0406', 'HR@20': '0.1017', 'NDCG@20': '0.0483'}
2025-05-23 18:43:49,107 - EarlyStopping counter: 1 out of 10
2025-05-23 18:44:09,647 - {'epoch': 38, 'rec_loss': '6.8851'}
2025-05-23 18:44:23,169 - {'Epoch': 38, 'HR@5': '0.0500', 'NDCG@5': '0.0341', 'HR@10': '0.0724', 'NDCG@10': '0.0413', 'HR@20': '0.1027', 'NDCG@20': '0.0489'}
2025-05-23 18:44:23,170 - EarlyStopping counter: 2 out of 10
2025-05-23 18:44:43,232 - {'epoch': 39, 'rec_loss': '6.8771'}
2025-05-23 18:44:56,753 - {'Epoch': 39, 'HR@5': '0.0504', 'NDCG@5': '0.0340', 'HR@10': '0.0730', 'NDCG@10': '0.0412', 'HR@20': '0.1019', 'NDCG@20': '0.0485'}
2025-05-23 18:44:56,754 - EarlyStopping counter: 3 out of 10
2025-05-23 18:45:17,489 - {'epoch': 40, 'rec_loss': '6.8718'}
2025-05-23 18:45:30,998 - {'Epoch': 40, 'HR@5': '0.0507', 'NDCG@5': '0.0344', 'HR@10': '0.0729', 'NDCG@10': '0.0415', 'HR@20': '0.1023', 'NDCG@20': '0.0489'}
2025-05-23 18:45:30,999 - EarlyStopping counter: 4 out of 10
2025-05-23 18:45:52,023 - {'epoch': 41, 'rec_loss': '6.8657'}
2025-05-23 18:46:05,629 - {'Epoch': 41, 'HR@5': '0.0502', 'NDCG@5': '0.0342', 'HR@10': '0.0722', 'NDCG@10': '0.0413', 'HR@20': '0.1035', 'NDCG@20': '0.0491'}
2025-05-23 18:46:05,634 - EarlyStopping counter: 5 out of 10
2025-05-23 18:46:26,366 - {'epoch': 42, 'rec_loss': '6.8628'}
2025-05-23 18:46:39,945 - {'Epoch': 42, 'HR@5': '0.0502', 'NDCG@5': '0.0341', 'HR@10': '0.0716', 'NDCG@10': '0.0409', 'HR@20': '0.1014', 'NDCG@20': '0.0484'}
2025-05-23 18:46:39,946 - EarlyStopping counter: 6 out of 10
2025-05-23 18:47:00,612 - {'epoch': 43, 'rec_loss': '6.8586'}
2025-05-23 18:47:14,177 - {'Epoch': 43, 'HR@5': '0.0492', 'NDCG@5': '0.0336', 'HR@10': '0.0712', 'NDCG@10': '0.0407', 'HR@20': '0.1024', 'NDCG@20': '0.0485'}
2025-05-23 18:47:14,178 - EarlyStopping counter: 7 out of 10
2025-05-23 18:47:35,012 - {'epoch': 44, 'rec_loss': '6.8503'}
2025-05-23 18:47:48,475 - {'Epoch': 44, 'HR@5': '0.0484', 'NDCG@5': '0.0335', 'HR@10': '0.0726', 'NDCG@10': '0.0412', 'HR@20': '0.1035', 'NDCG@20': '0.0490'}
2025-05-23 18:47:48,477 - EarlyStopping counter: 8 out of 10
2025-05-23 18:48:09,221 - {'epoch': 45, 'rec_loss': '6.8484'}
2025-05-23 18:48:22,836 - {'Epoch': 45, 'HR@5': '0.0492', 'NDCG@5': '0.0338', 'HR@10': '0.0725', 'NDCG@10': '0.0413', 'HR@20': '0.1032', 'NDCG@20': '0.0490'}
2025-05-23 18:48:22,840 - EarlyStopping counter: 9 out of 10
2025-05-23 18:48:43,482 - {'epoch': 46, 'rec_loss': '6.8452'}
2025-05-23 18:48:57,044 - {'Epoch': 46, 'HR@5': '0.0502', 'NDCG@5': '0.0342', 'HR@10': '0.0727', 'NDCG@10': '0.0415', 'HR@20': '0.1029', 'NDCG@20': '0.0491'}
2025-05-23 18:48:57,046 - EarlyStopping counter: 10 out of 10
2025-05-23 18:48:57,046 - Early stopping
2025-05-23 18:48:57,046 - ---------------Test Score---------------
2025-05-23 18:49:10,627 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0298', 'HR@10': '0.0635', 'NDCG@10': '0.0363', 'HR@20': '0.0880', 'NDCG@20': '0.0425'}
2025-05-23 18:49:10,628 - TVRec_Sports_best
2025-05-23 18:49:10,628 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0298', 'HR@10': '0.0635', 'NDCG@10': '0.0363', 'HR@20': '0.0880', 'NDCG@20': '0.0425'}
